(()=>{var t={337:(t,e,s)=>{"use strict";function i(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach((function(e){e&&Object.keys(e).forEach((function(s){t[s]=e[s]}))})),t}function u(t){return Object.prototype.toString.call(t)}function r(t){return"[object Function]"===u(t)}function _(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var n={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},a={"http:":{validate:function(t,e,s){var i=t.slice(e);return s.re.http||(s.re.http=new RegExp("^\\/\\/"+s.re.src_auth+s.re.src_host_port_strict+s.re.src_path,"i")),s.re.http.test(i)?i.match(s.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,s){var i=t.slice(e);return s.re.no_http||(s.re.no_http=new RegExp("^"+s.re.src_auth+"(?:localhost|(?:(?:"+s.re.src_domain+")\\.)+"+s.re.src_domain_root+")"+s.re.src_port+s.re.src_host_terminator+s.re.src_path,"i")),s.re.no_http.test(i)?e>=3&&":"===t[e-3]||e>=3&&"/"===t[e-3]?0:i.match(s.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,s){var i=t.slice(e);return s.re.mailto||(s.re.mailto=new RegExp("^"+s.re.src_email_name+"@"+s.re.src_host_strict,"i")),s.re.mailto.test(i)?i.match(s.re.mailto)[0].length:0}}},c="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function o(t){var e=t.re=s(66)(t.__opts__),i=t.__tlds__.slice();function n(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||i.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),i.push(e.src_xn),e.src_tlds=i.join("|"),e.email_fuzzy=RegExp(n(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(n(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(n(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(n(e.tpl_host_fuzzy_test),"i");var a=[];function c(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach((function(e){var s=t.__schemas__[e];if(null!==s){var i={validate:null,link:null};if(t.__compiled__[e]=i,"[object Object]"===u(s))return"[object RegExp]"!==u(s.validate)?r(s.validate)?i.validate=s.validate:c(e,s):i.validate=function(t){return function(e,s){var i=e.slice(s);return t.test(i)?i.match(t)[0].length:0}}(s.validate),void(r(s.normalize)?i.normalize=s.normalize:s.normalize?c(e,s):i.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===u(t)}(s)?c(e,s):a.push(e)}})),a.forEach((function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)})),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};var o=Object.keys(t.__compiled__).filter((function(e){return e.length>0&&t.__compiled__[e]})).map(_).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+o+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+e.src_ZPCc+"))("+o+")","ig"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function h(t,e){var s=t.__index__,i=t.__last_index__,u=t.__text_cache__.slice(s,i);this.schema=t.__schema__.toLowerCase(),this.index=s+e,this.lastIndex=i+e,this.raw=u,this.text=u,this.url=u}function l(t,e){var s=new h(t,e);return t.__compiled__[s.schema].normalize(s,t),s}function p(t,e){if(!(this instanceof p))return new p(t,e);var s;e||(s=t,Object.keys(s||{}).reduce((function(t,e){return t||n.hasOwnProperty(e)}),!1)&&(e=t,t={})),this.__opts__=i({},n,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=i({},a,t),this.__compiled__={},this.__tlds__=c,this.__tlds_replaced__=!1,this.re={},o(this)}p.prototype.add=function(t,e){return this.__schemas__[t]=e,o(this),this},p.prototype.set=function(t){return this.__opts__=i(this.__opts__,t),this},p.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;var e,s,i,u,r,_,n,a;if(this.re.schema_test.test(t))for((n=this.re.schema_search).lastIndex=0;null!==(e=n.exec(t));)if(u=this.testSchemaAt(t,e[2],n.lastIndex)){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+u;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(a=t.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||a<this.__index__)&&null!==(s=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(r=s.index+s[1].length,(this.__index__<0||r<this.__index__)&&(this.__schema__="",this.__index__=r,this.__last_index__=s.index+s[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&t.indexOf("@")>=0&&null!==(i=t.match(this.re.email_fuzzy))&&(r=i.index+i[1].length,_=i.index+i[0].length,(this.__index__<0||r<this.__index__||r===this.__index__&&_>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=r,this.__last_index__=_)),this.__index__>=0},p.prototype.pretest=function(t){return this.re.pretest.test(t)},p.prototype.testSchemaAt=function(t,e,s){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,s,this):0},p.prototype.match=function(t){var e=0,s=[];this.__index__>=0&&this.__text_cache__===t&&(s.push(l(this,e)),e=this.__last_index__);for(var i=e?t.slice(e):t;this.test(i);)s.push(l(this,e)),i=i.slice(this.__last_index__),e+=this.__last_index__;return s.length?s:null},p.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter((function(t,e,s){return t!==s[e-1]})).reverse(),o(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,o(this),this)},p.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},p.prototype.onCompile=function(){},t.exports=p},66:(t,e,s)=>{"use strict";t.exports=function(t){var e={};return e.src_Any=s(369).source,e.src_Cc=s(413).source,e.src_Z=s(45).source,e.src_P=s(189).source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|"),e.src_pseudo_letter="(?:(?![><｜]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><｜]|"+e.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><｜]|[()[\\]{}.,\"'?!\\-]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]).|"+(t&&t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+"\\,(?!"+e.src_ZCc+").|\\!+(?!"+e.src_ZCc+"|[!]).|\\?(?!"+e.src_ZCc+"|[?]).)+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+e.src_ZPCc+"))((?![$+<=>^`|｜])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}},835:(t,e)=>{"use strict";var s=function(){function t(t,e,s){void 0===s&&(s=localStorage),this.milliseconds=e,this.storage=s,this.key="ssc-"+t}return t.prototype.update=function(t){this.storage.setItem(this.key,JSON.stringify({data:t,expiration:Date.now()+this.milliseconds}))},t.prototype.get=function(){var t=this.storage.getItem(this.key);if(!t)return null;var e=JSON.parse(t);return Date.now()>=e.expiration?null:e},t}();e.Z=s},413:t=>{t.exports=/[\0-\x1F\x7F-\x9F]/},189:t=>{t.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},45:t=>{t.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},369:t=>{t.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/}},e={};function s(i){var u=e[i];if(void 0!==u)return u.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,s),r.exports}(()=>{"use strict";const t=s(337)(),e=e=>{let s=e;return t.test(e)&&t.match(e).forEach((({url:t})=>{s=e.replace(t,`<a href="${t}" target="_blank">${t}</a>`)})),s},i=(t,e)=>{t.classList.add(...e)},u=(t,e)=>{Object.entries(e).forEach(((e,s)=>{t.setAttribute(`data-${e}`,s)}))},r=(t,e)=>{t.append(...e)},_=(t="div",e={})=>{const s=document.createElement(t);return Object.entries(e).forEach((([t,e])=>{((t,e,s)=>{const _={classList:i,dataset:u,children:r}[e];void 0===_?t[e]=s:_(t,s)})(s,t,e)})),s},n=({text:t="",type:s="default",children:i=[]})=>_("p",{innerHTML:t?e(t):"",classList:["line",s],children:i}),a=(t,{value:e="",children:s=[]})=>n({text:`${t}: ${e}`,type:"info",children:s}),c=()=>_("div",{classList:["loader"]}),o=t=>"metric"===t?'<span class="unit-active">C</span> ⇄ F':'<span class="unit-active">F</span> ⇄ C',h=t=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t).toISOString().slice(11,16)};class l{constructor({parentElement:t,weatherApi:e,city:s="",units:i="metric"}){this.sessionParent=t,this.weatherApi=e,this.units=i,this.initialCity=s}startNewSession(){Object.assign(this,((t,e)=>{const s=_("input",{type:"text",id:"city-name",name:"city-name",placeholder:t}),i=_("label",{textContent:"City name:",children:[s]}),u=_("div",{classList:["session-wrapper"],children:[n({children:[i]})]});return s.addEventListener("keyup",e),{cityNameInput:s,sessionWrapper:u}})(this.initialCity,this.keypress.bind(this)),((t,e)=>{const s=_("span",{classList:["temp"]}),i=_("button",{classList:["toggle"],innerHTML:o(t)}),u=a("temp",{children:[s,i]});return i.addEventListener("click",e),{temperatureLine:u,temperature:s}})(this.units,this.changeUnit.bind(this))),this.sessionParent.append(this.sessionWrapper),this.cityNameInput.focus()}async keypress(t){"Enter"===t.key&&(this.setRequestedCity(),await this.handleResponse(),new l({parentElement:this.sessionParent,weatherApi:this.weatherApi,city:this.initialCity}).startNewSession())}setRequestedCity(){this.cityNameInput.value||(this.cityNameInput.value=this.cityNameInput.placeholder),this.requestedCity=this.cityNameInput.value,this.cityNameInput.disabled=!0}async getWeather(){this.appendLine(c());const t=await this.weatherApi({q:this.requestedCity,units:this.units});Object.assign(this,{data:t})}async handleResponse(){try{await this.getWeather(),this.displayTitle(),this.displayInfo()}catch(t){this.replaceLine(n({text:t.message,type:"error"}))}}async changeUnit(t){const e="BUTTON"===t.target.tagName?t.target:t.target.parentElement;this.temperature.textContent="metric"===this.units?(9*this.temperature.textContent/5+32).toLocaleString(void 0,{maximumFractionDigits:2}):(5*(this.temperature.textContent-32)/9).toLocaleString(void 0,{maximumFractionDigits:2}),this.units="metric"===this.units?"imperial":"metric",e.innerHTML=o(this.units)}appendLine(...t){this.sessionWrapper.append(...t)}replaceLine(...t){this.sessionWrapper.lastChild.replaceWith(...t)}displayTitle(){var t;this.replaceLine(n({text:`${this.data.name}, ${this.data.sys.country}`,type:"title",children:[(t=this.data.weather[0].icon,_("img",{src:`https://openweathermap.org/img/wn/${t}.png`,alt:"weather icon",classList:["icon",t.endsWith("d")?"day":"night"]}))]}))}displayInfo(){const{timezone:t="",weather:[{main:e="",description:s=""}],main:{temp:i="",pressure:u="",humidity:r=""},cache:_}=this.data;this.temperature.textContent=i,this.appendLine(this.temperatureLine,...Object.entries({time:h(t),main:e.toLowerCase(),description:s,pressure:`${u}hPa`,humidity:`${r}%`,cache:_&&new Date(_).toISOString()}).map((([t,e])=>a(t,{value:e}))))}}const p=l;var d=s(835);const m="https://vast-lake-71168.herokuapp.com/",D=(t,e)=>async(s={})=>{const i=new URL(t);Object.entries(s).forEach((([t,e])=>{i.searchParams.append(t,e)}));const u=new d.Z(i.toString().toLowerCase(),e),r=u.get();if(r){const{data:t,expiration:e}=r;return{...t,cache:new Date(e)}}const _=await fetch(i);if(!_.ok)throw new Error(`${_.statusText} (${_.status})`);const n=await _.json();return u.update(n),{...n,cache:!1}},F=D(`${m}ipinfo`,18e5),f=D(`${m}weather`,6e5),y=document.querySelector("main"),C=_("div",{children:[c()," Loading..."]});y.append(C),F().then((t=>{C.remove(),new p({parentElement:y,weatherApi:f,city:`${t.city}, ${t.country}`}).startNewSession()})).catch((t=>{y.append(t.message)}))})()})();
//# sourceMappingURL=main.[contentHash].js.map